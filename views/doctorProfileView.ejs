<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Profile: <%= doctor.name %></title>
</head>

<body>
    <h1>Doctor Profile: <%= doctor.name %></h1>
    <p><strong>Specialty:</strong> <%= doctor.speciality.join(', ') %></p>
    <p><strong>Location:</strong> <%= doctor.city %>, <%= doctor.state %>, <%= doctor.country %></p>
    <p><strong>Languages Spoken:</strong> <%= doctor.languages.join(', ') %></p>
    <p><strong>Gender:</strong> <%= doctor.gender %></p>
    <p><strong>Availability:</strong> <%= doctor.availability ? 'Available' : 'Not Available' %></p>
    <p><strong>Profile Views:</strong> <%= doctor.profileViews || 0 %></p>

    <h2>Consultation Information</h2>
    <p><strong>Consultation Type:</strong> <%= doctor.consultation %></p>

    <% if (doctor.timeSlots && doctor.timeSlots.length > 0) { %>
        <h2>Available Time Slots</h2>
        <ul>
            <% doctor.timeSlots.forEach(slot => { %>
                <li>
                    <% if (slot.date) { %>
                        <p><strong>Date:</strong> <%= slot.date.toDateString() %></p>
                    <% } else { %>
                        <p><strong>Date:</strong> N/A</p>
                    <% } %>

                    <% if (slot.startTime && slot.endTime) { %>
                        <p><strong>Time:</strong> <%= slot.startTime %> - <%= slot.endTime %></p>
                    <% } else { %>
                        <p><strong>Time:</strong> N/A</p>
                    <% } %>

                    <% if (slot.hospital) { %>
                        <p><strong>Hospital:</strong> <%= slot.hospital %></p>
                    <% } else { %>
                        <p><strong>Hospital:</strong> N/A</p>
                    <% } %>

                    <% if (slot.hospitalLocation) { %>
                        <p><strong>Location:</strong> <%= slot.hospitalLocation.street %>, <%= slot.hospitalLocation.city %>, <%= slot.hospitalLocation.state %>, <%= slot.hospitalLocation.country %>, <%= slot.hospitalLocation.zip %></p>
                    <% } else { %>
                        <p><strong>Location:</strong> N/A</p>
                    <% } %>

                    <% if (slot.status === 'free') { %>
                        <form action="/patient/book" method="POST">
                            <input type="hidden" name="doctorId" value="<%= doctor._id %>">
                            <input type="hidden" name="date" value="<%= slot.date.toISOString() %>">
                            <input type="hidden" name="time" value="<%= slot.startTime %> - <%= slot.endTime %>">
                            
                            <label for="consultationType"><strong>Consultation Type:</strong></label>
                            <select id="consultationType" name="consultationType">
                                <option value="In-person">In-person</option>
                                <option value="Video call">Video call</option>
                            </select>
                            
                            <button type="submit">Book Slot</button>
                        </form>
                    <% } else { %>
                        <p><strong>Status:</strong> <%= slot.status %></p>
                    <% } %>
                </li>
            <% }) %>
        </ul>
    <% } else { %>
        <p>No available time slots.</p>
    <% } %>

    <form action="/patient/add-to-favorites" method="POST">
        <input type="hidden" name="doctorId" value="<%= doctor._id %>">
        <button type="submit">Add to Favorites</button>
    </form>

    <a href="/patient/doctors">Back to Doctors List</a>
</body>

</html>
